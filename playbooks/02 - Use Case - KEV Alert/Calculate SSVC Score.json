{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Calculate SSVC Score",
    "aliasName": null,
    "tag": null,
    "description": "Update SSVC Score for each KEV CVE.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db7036e6-4e35-4479-beea-d7fefc73ab68",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/bf237623-8d4e-4b9a-bfaa-5fa6e078d14c",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Incomplete Tasks Message",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Stakeholder Specific Vulnerability Categorization (SSVC)",
                        "description": "<h6>Please complete pending tasks to calculate SSVC Score:<\/h6>\n<hr>\n{% for data in vars.steps.Get_CVEs_SSVC_Score['output']['IRI'] %}<li><a href=\"\/modules\/tasks\/{{data.split('\/')[-1]}}\" target=\"_blank\" rel=\"noopener\">{{(data | fromIRI).name}}<\/a><\/li>{% endfor %}\n\n",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "k_e_v_alerts",
                "owner_detail": {
                    "isAssigned": true,
                    "assignedToTeam": [],
                    "assignedToField": "assignedTo",
                    "assignedToPerson": [],
                    "assignedToRecord": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Ok",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/d5bf53dc-4fb6-4afb-8416-f365f3727ce4"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false
            },
            "status": null,
            "top": "435",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "02ac782b-3e4c-4471-9555-91f1979f984b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get CVEs SSVC Score",
            "description": null,
            "arguments": {
                "arguments": {
                    "cVERecord": "",
                    "kevAlertData": "{{vars.input.records[0]}}",
                    "iCSAdvisoryID": ""
                },
                "apply_async": false,
                "step_variables": {
                    "ssvcOutput": "{{vars.steps.Get_CVEs_SSVC_Score['output']}}"
                },
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/a99bc56f-cd58-4703-b4a9-93f4e0f6236b"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "5dc92876-cc18-4cd8-b64c-61f51bfb54a0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Incomplete Task Exists",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/02ac782b-3e4c-4471-9555-91f1979f984b",
                        "condition": "{{ 'Pending' in vars.ssvcOutput['statusMessage'] }}",
                        "step_name": "Incomplete Tasks Message"
                    },
                    {
                        "option": "No",
                        "step_iri": "\/api\/3\/workflow_steps\/fad0a108-6a9b-4dbd-a77e-bf810795a2b8",
                        "condition": "{{ 'Completed' in vars.ssvcOutput['statusMessage'] }}",
                        "step_name": "Calculation Message"
                    }
                ]
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "8710cff1-3ecf-44df-b027-a8d60589398a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update KEV Alert",
            "description": null,
            "arguments": {
                "resource": {
                    "vulnerabilityAssignment": "<p><svg width=\"1100\" height=\"70\"> <g> <circle style=\"fill: #b0c4de; stroke: #3598db;\" r=\"10\" cy=\"55\" cx=\"20\"><\/circle> <text style=\"font-size: 15px; fill: #3598db;\" y=\"30\" x=\"0\">Exploitation<\/text> <path style=\"stroke: #3598db; stroke-width: 2;\" d=\"M 30,55 C 30,55 30,55 240,55\" id=\"chk1\"><\/path> <text text-anchor=\"middle\" dx=\"120\" dy=\"48\" style=\"stroke: #3598db;\"> {{vars.ssvcOutput['SSVC']['Exploitation'] | lower}} <\/text> <\/g> <g> <circle style=\"fill: #b0c4de; stroke: #3598db;\" r=\"10\" cy=\"55\" cx=\"240\"><\/circle> <text style=\"font-size: 15px; fill: #3598db;\" y=\"30\" x=\"200\">Automatable<\/text> <path style=\"stroke: #3598db; stroke-width: 2;\" d=\"M 250,55 C 250,55 250,55 460,55\" id=\"chk2\"><\/path> <text text-anchor=\"middle\" dx=\"340\" dy=\"48\" style=\"stroke: #3598db;\"> {{vars.ssvcOutput['SSVC']['Automatable'] | lower}} <\/text> <\/g> <g> <circle style=\"fill: #b0c4de; stroke: #3598db;\" r=\"10\" cy=\"55\" cx=\"460\"><\/circle> <text style=\"font-size: 15px; fill: #3598db;\" y=\"30\" x=\"410\">Technical Impact <\/text> <path style=\"stroke: #3598db; stroke-width: 2;\" d=\"M 470,55 C 470,55 470,55 680,55\" id=\"chk3\"><\/path> <text text-anchor=\"middle\" dx=\"560\" dy=\"48\" style=\"stroke: #3598db;\"> {{vars.ssvcOutput['SSVC']['Technical Impact'] | lower}} <\/text> <\/g> <g> <circle style=\"fill: #b0c4de; stroke: #3598db;\" r=\"10\" cy=\"55\" cx=\"680\"><\/circle> <text style=\"font-size: 15px; fill: #3598db;\" y=\"30\" x=\"620\">Mission &amp; Well-being <\/text> <path style=\"stroke: #3598db; stroke-width: 2;\" d=\"M 690,55 C 690,55 690,55 900,55\" id=\"chk4\"><\/path> <text text-anchor=\"middle\" dx=\"780\" dy=\"48\" style=\"stroke: #3598db;\"> {{(vars.ssvcOutput['SSVCResult']) | lower}} <\/text> <\/g> <g> <circle style=\"fill: {{vars.ssvcOutput['SSVCColor']}};\" r=\"10\" cy=\"55\" cx=\"900\"><\/circle> <text style=\"font-size: 15px; fill: {{vars.ssvcOutput['SSVCColor']}};\" y=\"50\" x=\"915\">{{vars.ssvcOutput['FinalOutput']}} <\/text> <\/g> <\/svg><\/p>\n<h6><span style=\"text-decoration: underline; color: #e67e23;\"> <span style=\"font-size: 10pt;\">Vulnerability Scoring Decision<\/span> <\/span><\/h6>\n<h6><span style=\"font-size: 10pt; color: {{vars.ssvcoutput['ssvccolor']}};\">{{vars.ssvcOutput['FinalOutput']}}: {{vars.ssvcOutput['SSVCText']}}<\/span><\/h6>"
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/k_e_v_alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "b08ba562-c643-45dd-8bbc-c1b9fa875d99"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "route": "99f35126-5bda-4144-ac3e-f434882a5234",
                "resources": [
                    "k_e_v_alerts"
                ],
                "inputVariables": [],
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": "{{vars.input.records}}"
                    }
                },
                "displayConditions": {
                    "tasks": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "c_v_es": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "k_e_v_alerts": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    },
                    "mitre_mitigations": {
                        "sort": [],
                        "limit": 30,
                        "logic": "AND",
                        "filters": []
                    }
                },
                "executeButtonText": "Execute",
                "noRecordExecution": false,
                "singleRecordExecution": true
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
            "group": null,
            "uuid": "bf237623-8d4e-4b9a-bfaa-5fa6e078d14c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Calculation Message",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Stakeholder Specific Vulnerability Categorization (SSVC)",
                        "description": "<h5>The assigned tasks have been completed. The <i>Evaluation<\/i> tab will contains SSVC Score for KEV CVEs.<\/h5>",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "k_e_v_alerts",
                "owner_detail": {
                    "isAssigned": false
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Ok",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/b08ba562-c643-45dd-8bbc-c1b9fa875d99"
                        }
                    ],
                    "duplicateOption": false
                },
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inline_channel_list": [],
                "external_channel_list": [],
                "unauthenticated_input": false
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": null,
            "uuid": "fad0a108-6a9b-4dbd-a77e-bf810795a2b8"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Incomplete Task Exists -> Calculation Message",
            "targetStep": "\/api\/3\/workflow_steps\/fad0a108-6a9b-4dbd-a77e-bf810795a2b8",
            "sourceStep": "\/api\/3\/workflow_steps\/8710cff1-3ecf-44df-b027-a8d60589398a",
            "label": "No",
            "isExecuted": false,
            "uuid": "03134435-5fb4-4360-a815-3081409690c1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Calculation Message -> Update KEV Alert",
            "targetStep": "\/api\/3\/workflow_steps\/b08ba562-c643-45dd-8bbc-c1b9fa875d99",
            "sourceStep": "\/api\/3\/workflow_steps\/fad0a108-6a9b-4dbd-a77e-bf810795a2b8",
            "label": "Ok",
            "isExecuted": false,
            "group": null,
            "uuid": "39623f97-a044-42ef-8ea0-2c1f52addf59"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Incomplete Task Exists -> Incomplete Tasks Message",
            "targetStep": "\/api\/3\/workflow_steps\/02ac782b-3e4c-4471-9555-91f1979f984b",
            "sourceStep": "\/api\/3\/workflow_steps\/8710cff1-3ecf-44df-b027-a8d60589398a",
            "label": "Yes",
            "isExecuted": false,
            "uuid": "3feb1ae2-b028-4fd4-90a8-3f3ec7fb4009"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get CVEs SSVC Score -> Incomplete Task Exists",
            "targetStep": "\/api\/3\/workflow_steps\/8710cff1-3ecf-44df-b027-a8d60589398a",
            "sourceStep": "\/api\/3\/workflow_steps\/5dc92876-cc18-4cd8-b64c-61f51bfb54a0",
            "label": null,
            "isExecuted": false,
            "uuid": "4cee530a-0239-4fe8-8be8-5fc4f21bfdd5"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Get CVEs SSVC Score",
            "targetStep": "\/api\/3\/workflow_steps\/5dc92876-cc18-4cd8-b64c-61f51bfb54a0",
            "sourceStep": "\/api\/3\/workflow_steps\/bf237623-8d4e-4b9a-bfaa-5fa6e078d14c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "84986f70-79f1-4da6-8cff-ef105805641a"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "e2e5cf31-e7ec-4216-8a9e-2d02d31b88fe",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "CVE",
        "ICS Advisory",
        "IT OT",
        "KEV Alert",
        "ManualTrigger",
        "SSVC Score",
        "Tasks"
    ]
}