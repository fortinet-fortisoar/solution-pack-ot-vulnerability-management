{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> SSVC For CVEs",
    "aliasName": null,
    "tag": null,
    "description": "Reference playbook to calculate score if all task is completed.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "cVERecord",
        "iCSAdvisoryID",
        "kevAlertData"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db7036e6-4e35-4479-beea-d7fefc73ab68",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/98acc115-42a7-4e54-89c7-9fa43bbd936e",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "InComplete Message",
            "description": null,
            "arguments": {
                "output": "{% set result = {} %}{% set _ = result.update({'statusMessage':\"Pending\", 'IRI':vars.incompleteTasks | json_query('[*][\"@id\"][]')}) %}{{result}}"
            },
            "status": null,
            "top": "570",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "1bdcb754-8d6f-4969-8ee1-e19ae555de01"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Results",
            "description": null,
            "arguments": {
                "ssvcFinalOutput": "{{vars.ssvcFinalResult.get(vars.exploitation).get(vars.automatable).get(vars.technicalImpact).get(vars.ssvcResult)}}"
            },
            "status": null,
            "top": "840",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "38c317e2-d5a5-435d-a067-b80f2c3183c4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Incomplete Task Exists",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/1bdcb754-8d6f-4969-8ee1-e19ae555de01",
                        "condition": "{{ vars.incompleteTasks | length > 0 }}",
                        "step_name": "InComplete Message"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/d83b31f2-97be-4f78-bd90-05955b14c1c0",
                        "step_name": "Get SSVC Score"
                    }
                ]
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "41fa55a7-c73f-4798-b0d1-108773587d26"
        },
        {
            "@type": "WorkflowStep",
            "name": "Complete Message",
            "description": null,
            "arguments": {
                "output": "{% set result = {} %}{% set _ = result.update({'statusMessage':\"Completed\",\n'FinalOutput':vars.ssvcFinalOutput,'SSVC':(vars.kevCveCorrelatedData['sSVC'] ), 'SSVCResult':vars.ssvcResult, 'SSVCColor':vars.ssvcColor, 'SSVCText':vars.ssvcText}) %}{{result}}"
            },
            "status": null,
            "top": "1245",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "54f0aae9-02f7-4026-9ac4-5ee2a19dd614"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get SSVC Color And Text",
            "description": null,
            "arguments": {
                "ssvcText": "{{vars.finalOutputtMap.get(vars.ssvcFinalOutput)}}",
                "ssvcColor": "{{\"SSVCCalculator\" | picklist(vars.ssvcFinalOutput, \"color\")}}"
            },
            "status": null,
            "top": "975",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "93450941-2543-4fa8-a037-9679a9dca984"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "98acc115-42a7-4e54-89c7-9fa43bbd936e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Incomplete Tasks",
            "description": null,
            "arguments": {
                "ssvc": "{{vars.kevCveCorrelatedData['sSVC']}}",
                "incompleteTasks": "{% set data = [] %}{% for item in vars.kevCveCorrelatedData['tasks'] %}{% if item['priority'] == '\/api\/3\/picklists\/612befbc-4255-403a-958b-11efce3e1d8c' and item['status'] != '\/api\/3\/picklists\/343f4b67-e929-4205-bf95-ba5b70545fed' %}{% set _ = data.append(item) %}{% endif %}{% endfor %}{{data}}"
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "a3f23a8d-62f5-4749-893b-7a2170421350"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "ssvcOutput": "{\n  \"Minimal\": {\n    \"Minimal\": \"Low\",\n    \"Material\": \"Medium\",\n    \"Irreversible\": \"High\"\n  },\n  \"Support\": {\n    \"Minimal\": \"Medium\",\n    \"Material\": \"Medium\",\n    \"Irreversible\": \"High\"\n  },\n  \"Essential\": {\n    \"Minimal\": \"High\",\n    \"Material\": \"High\",\n    \"Irreversible\": \"High\"\n  }\n}",
                "finalOutputtMap": "{\n  \"Track\":\"The vulnerability does not require action at this time. The organization would continue to track the vulnerability and reassess it if new information becomes available. CISA recommends remediating Track vulnerabilities within standard update timelines.\",\n  \"Track*\":\"The vulnerability contains specific characteristics that may require closer monitoring for changes. CISA recommends remediating Track* vulnerabilities within standard update timelines.\",\n  \"Attend\":\"The vulnerability requires attention from the organization's internal, supervisory-level individuals. Necessary actions may include requesting assistance or information about the vulnerability and may involve publishing a notification, either internally and\/or externally, about the vulnerability. CISA recommends remediating Attend vulnerabilities sooner than standard update timelines.\",\n  \"Act\":\"The vulnerability requires attention from the organization's internal, supervisory-level and leadership-level individuals. Necessary actions include requesting assistance or information about the vulnerability, as well as publishing a notification either internally and\/or externally. Typically, internal groups would meet to determine the overall response and then execute agreed upon actions. CISA recommends remediating Act vulnerabilities as soon as possible.\"\n}",
                "ssvcFinalResult": "{\n  \"Poc\": {\n    \"No\": {\n      \"Total\": {\n        \"Low\": \"Track\",\n        \"High\": \"Attend\",\n        \"Medium\": \"Track*\"\n      },\n      \"Partial\": {\n        \"Low\": \"Track\",\n        \"High\": \"Attend\",\n        \"Medium\": \"Track\"\n      }\n    },\n    \"Yes\": {\n      \"Total\": {\n        \"Low\": \"Track\",\n        \"High\": \"Attend\",\n        \"Medium\": \"Track*\"\n      },\n      \"Partial\": {\n        \"Low\": \"Track\",\n        \"High\": \"Track*\",\n        \"Medium\": \"Track\"\n      }\n    }\n  },\n  \"Active\": {\n    \"No\": {\n      \"Total\": {\n        \"Low\": \"Attend\",\n        \"High\": \"Act\",\n        \"Medium\": \"Act\"\n      },\n      \"Partial\": {\n        \"Low\": \"Attend\",\n        \"High\": \"Act\",\n        \"Medium\": \"Attend\"\n      }\n    },\n    \"Yes\": {\n      \"Total\": {\n        \"Low\": \"Track\",\n        \"High\": \"Act\",\n        \"Medium\": \"Attend\"\n      },\n      \"Partial\": {\n        \"Low\": \"Track\",\n        \"High\": \"Attend\",\n        \"Medium\": \"Track\"\n      }\n    }\n  }\n}",
                "kevCveCorrelatedData": "{{(vars.input.params.kevAlertData['@id']+\"?$relationships=true\") | fromIRI}}"
            },
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "d469888e-b4fe-4e8b-88f9-f5c12cddc4dc"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get SSVC Score",
            "description": null,
            "arguments": {
                "wellBeing": "{{vars.ssvc['Well Being']}}",
                "automatable": "{{vars.ssvc['Automatable']}}",
                "exploitation": "{{vars.ssvc['Exploitation']}}",
                "technicalImpact": "{{vars.ssvc['Technical Impact']}}",
                "mitigationStatus": "{{vars.ssvc['Mitigation Status']}}",
                "automatableReason": "{{vars.ssvc['Automatable Reason']}}",
                "missionPrevalence": "{{vars.ssvc['Mission Prevalence']}}"
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "d83b31f2-97be-4f78-bd90-05955b14c1c0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Low Or Medium Or High",
            "description": null,
            "arguments": {
                "ssvcResult": "{{vars.ssvcOutput.get(vars.missionPrevalence).get(vars.wellBeing)}}"
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "e2b34f25-3181-45d1-b2db-ea6d74b16706"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update KEV Alert With SSVC",
            "description": null,
            "arguments": {
                "resource": {
                    "sSVCAnalysis": "{{\"SSVCCalculator\" | picklist(vars.ssvcFinalOutput, \"@id\")}}"
                },
                "operation": "Append",
                "collection": "{{vars.input.params.kevAlertData['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/k_e_v_alerts",
                "fieldOperation": {
                    "recordTags": "Append"
                },
                "step_variables": []
            },
            "status": null,
            "top": "1110",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "8ba82dbe-b6b7-4ce6-8328-8859b6cbbb64"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/d469888e-b4fe-4e8b-88f9-f5c12cddc4dc",
            "sourceStep": "\/api\/3\/workflow_steps\/98acc115-42a7-4e54-89c7-9fa43bbd936e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ff84c278-1d4c-4ff4-a6c6-999fda112b86"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Incomplete Tasks",
            "targetStep": "\/api\/3\/workflow_steps\/a3f23a8d-62f5-4749-893b-7a2170421350",
            "sourceStep": "\/api\/3\/workflow_steps\/d469888e-b4fe-4e8b-88f9-f5c12cddc4dc",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "5a670605-70d6-4764-b092-96590fdfc7ba"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Incomplete Tasks -> Incomplete Task Exists",
            "targetStep": "\/api\/3\/workflow_steps\/41fa55a7-c73f-4798-b0d1-108773587d26",
            "sourceStep": "\/api\/3\/workflow_steps\/a3f23a8d-62f5-4749-893b-7a2170421350",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "0d146ee0-0d95-42f4-8e2e-f7337d6831f8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Incomplete Task Exists -> InComplete Message",
            "targetStep": "\/api\/3\/workflow_steps\/1bdcb754-8d6f-4969-8ee1-e19ae555de01",
            "sourceStep": "\/api\/3\/workflow_steps\/41fa55a7-c73f-4798-b0d1-108773587d26",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "0c1f1b19-0efb-4115-a0f5-e6bccb5021cc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Incomplete Task Exists -> Get SSVC Score",
            "targetStep": "\/api\/3\/workflow_steps\/d83b31f2-97be-4f78-bd90-05955b14c1c0",
            "sourceStep": "\/api\/3\/workflow_steps\/41fa55a7-c73f-4798-b0d1-108773587d26",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "4a51dd48-9330-4dfa-ba61-ab0f357c96ee"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get SSVC Score -> Get Low Or Medium Or High",
            "targetStep": "\/api\/3\/workflow_steps\/e2b34f25-3181-45d1-b2db-ea6d74b16706",
            "sourceStep": "\/api\/3\/workflow_steps\/d83b31f2-97be-4f78-bd90-05955b14c1c0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a4ae4d30-8e86-4cb8-9f41-8d67fabb8c22"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Low Or Medium Or High -> Get Results",
            "targetStep": "\/api\/3\/workflow_steps\/38c317e2-d5a5-435d-a067-b80f2c3183c4",
            "sourceStep": "\/api\/3\/workflow_steps\/e2b34f25-3181-45d1-b2db-ea6d74b16706",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "384bf5ab-fc24-43fa-8ef8-7016459f7b4e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Results -> Get SSVC Color And Text",
            "targetStep": "\/api\/3\/workflow_steps\/93450941-2543-4fa8-a037-9679a9dca984",
            "sourceStep": "\/api\/3\/workflow_steps\/38c317e2-d5a5-435d-a067-b80f2c3183c4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7d929633-4003-472a-8d7a-d37ff6a0222e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get SSVC Color And Text -> Update KEV Alert With SSVC",
            "targetStep": "\/api\/3\/workflow_steps\/8ba82dbe-b6b7-4ce6-8328-8859b6cbbb64",
            "sourceStep": "\/api\/3\/workflow_steps\/93450941-2543-4fa8-a037-9679a9dca984",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "63fa9943-f3ed-40a8-b7d1-1b701f41f657"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update KEV Alert With SSVC -> Complete Message",
            "targetStep": "\/api\/3\/workflow_steps\/54f0aae9-02f7-4026-9ac4-5ee2a19dd614",
            "sourceStep": "\/api\/3\/workflow_steps\/8ba82dbe-b6b7-4ce6-8328-8859b6cbbb64",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ec19f89a-35b0-4b5a-a4ff-0d120498a04a"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "a99bc56f-cd58-4703-b4a9-93f4e0f6236b",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "CVE",
        "IT OT",
        "KEV Alert",
        "Referenced",
        "SSVC Score"
    ]
}